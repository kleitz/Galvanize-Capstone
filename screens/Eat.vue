<template>
  <nb-container>
    <Header />
    <nb-content>
      <nb-text>Tap on items to add them to your cart</nb-text>
      <nb-list>
        <nb-list-item itemHeader first>
          <nb-text>FOOD ITEMS</nb-text>
        </nb-list-item>
        <nb-list-item :key="index" v-for="(item, index) in menuItems.menuItems" button>
          <touchable-opacity :on-press="() => addToCart(item)">
            <nb-left>
              <image
                :style="{ width: 100, height: 100, marginRight: 10}"
                :source="{uri: item.imageUrl}"/>
              <nb-text>{{ item.name }}</nb-text>
            </nb-left>
            <nb-right>
              <nb-text>${{ item.price }}</nb-text>
            </nb-right>
          </touchable-opacity>
        </nb-list-item>
      </nb-list>
    </nb-content>
    <Footer :navigation="navigation"/> 
    <!-- <nb-footer>
      <nb-footer-tab>
        <nb-button :active="tab1" :onPress="toggleTab1">
          <nb-icon name="flag" :active="tab1" />
          <nb-text>Book</nb-text>
        </nb-button>
        <nb-button :active="tab2" :onPress="toggleTab2">
          <nb-icon name="pizza" :active="tab2" />
          <nb-text>Eat</nb-text>
        </nb-button>
        <nb-button :active="tab3" :onPress="toggleTab3">
          <nb-icon name="beer" :active="tab3" />
          <nb-text>Shop</nb-text>
        </nb-button>
        <nb-button :active="tab4" :onPress="toggleTab4">
          <nb-icon name="cash" :active="tab4" />
          <nb-text>Pay</nb-text>
        </nb-button>
      </nb-footer-tab>
    </nb-footer> -->
  </nb-container>

 
</template>

<script>
import API from "../API.js";
import Header from "../components/Header";
import Footer from "../components/Footer";

export default {
  props: {
    navigation: {
      type: Object
    }
  },
  components: {
    Header,
    Footer
  },
  data: function() {
    return {
      menuItems: [],
      cartItem: {}
    };
  },
  async mounted() {
    this.menuItems = await API.getMenuItems();
    this.menuItems.menuItems.reverse();
  },
  methods: {
    buildCartItem(item) {
      this.cartItem = {
        name: item.name,
        price: item.price,
        description: item.description,
        imageUrl: item.imageUrl,
        quantity: item.quantity
      };
      console.log(this.cartItem);
    },
    addToCart(item) {
      this.buildCartItem(item);
      return fetch(`${API.API_URL}cart`, {
        method: "POST",
        body: JSON.stringify(this.cartItem),
        headers: {
          "content-type": "application/json",
          mode: "cors",
          cache: "default"
        }
      });
      // This will add the item to the cart page
      // hmmmmmmm..... alert(`Added to cart`);
    }
    // postToCart() {
    //   this.item.quantity_available--;
    //   return fetch(`${API.API_URL}/cart`, {
    //     method: 'POST',
    //     body: JSON.stringify(this.newCartItem),
    //     headers: {
    //       'content-type': 'application/json',
    //       mode: 'cors',
    //       cache: 'default',
    //     },
    //   })
    //     .then(alert(`1 ${this.item.name} successfully added to shopping cart!`))
    //     .catch(error => console.error(error));
    // },
  }
};
</script>

<style>
.purchase-item img {
  /* display: flex; */
  /* justify-content: space-between; */
}
</style>
